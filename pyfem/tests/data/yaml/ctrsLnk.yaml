# http://yaml-online-parser.appspot.com

dos:
  lnkAdd|Cmp.kirmse|Cmp.ni|area-company:
    test: #ctrs.lnk.add()
      {chld_: {_cls: Cmp, slug: kirmse}, par_: {_cls: Cmp, slug: ni}, role_: area-company}
    expect:
      flds:
        _cls: D.Cnt.Cmp
        slug: kirmse
      evals:
        doc['pars'][0]['cls']: Cmp
        doc['pars'][0]['slug']: ni
        doc['pars'][0]['role']: area
        doc['pths'][0]['cls']: Cmp
        doc['pths'][0]['slug']: ni
        doc['pths'][0]['role']: company
  lnkAdd|Cmp.unit104|Cmp.kirmse|unit-area:
    test:
      {chld_: {_cls: Cmp, slug: unit104}, par_: {_cls: Cmp, slug: kirmse}, role_: unit-area}
    expect:
      flds:
        _cls: D.Cnt.Cmp
        slug: unit104
      evals:
        doc['pars'][0]['cls']: Cmp
        doc['pars'][0]['slug']: kirmse
        doc['pars'][0]['role']: unit
        doc['pths'][0]['cls']: Cmp
        doc['pths'][0]['slug']: kirmse
        doc['pths'][0]['role']: area
  lnkAdd|Cmp.troop1031|Cmp.unit104|troop-unit:
    test:
      {chld_: {_cls: Cmp, slug: troop1031}, par_: {_cls: Cmp, slug: unit104}, role_: troop-unit}
    expect:
      flds:
        _cls: D.Cnt.Cmp
        slug: troop1031
      evals:
        doc['pars'][0]['cls']: Cmp
        doc['pars'][0]['slug']: unit104
        doc['pars'][0]['role']: troop
        doc['pths'][0]['cls']: Cmp
        doc['pths'][0]['slug']: unit104
        doc['pths'][0]['role']: unit
  
  lnkAdd|Cmp.ni|Pl.atlanta-ga|office:
    test: #ctrs.lnk.add()
      {chld_: {_cls: Cmp, slug: ni}, par_: {_cls: Pl, slug: atlanta-ga}, role_: office}
    expect:
      flds:
        _cls: D.Cnt.Cmp
        slug: ni
      evals:
        doc['pars'][0]['cls']: Pl
        doc['pars'][0]['slug']: atlanta-ga
        doc['pars'][0]['role']: office
        doc['pths'][0]['cls']: Pl
        doc['pths'][0]['slug']: atlanta-ga
        doc['pths'][0]['role']: office


  del|Cmp.kirmse|Cmp.ni|area-company:
    test:
      del: {fr: {_cls: Cmp, slug: kirmse}, to: {_cls: Cmp, slug: ni}, role: area-company}



  updt|Cmp.kirmse|Cmp.ni|area-company:
    # just use generic put to update role, etc?
    test:
      updt: {fr: {_cls: Cmp, slug: kirmse}, to: {_cls: Cmp, slug: ni}, role: area-company}





  lnkUsr.lwe_Cmp.ni_admin:
    _cls: Usr
    query: 
      slug: lwe
    update:
      actions:
        $push:
          flds:
            pars:
              - _cls  : Par
                _types: [Par]
                lnk   : Cmp.ni.admin.11
            pths:
              - cls: Pth
                _types: [Pth]
                lnk   : Cmp.ni.admin.11
                uris  :
                  - Cmp.ni
                  - Usr.lwe
  lnkUsr.lwe_Pl.cr_home:
    _cls: Usr
    query: 
      slug: lwe
    update:
      actions:
        $push:
          flds:
            pars:
              - _cls  : Par
                _types: [Par]
                lnk   : Pl.cr.home
            pths:
              - cls: Pth
                _types: [Pth]
                lnk   : Pl.cr.home
                uris  :
                  - Pl.cr
                  - Usr.lwe
expect:
  put__Cmp.kirmse_Cmp.ni_dept-company:
    _cls: Cmp
    slug: ni
    pars:
      - {lnk: Cmp.ni.admin.11}
    pths:
      - {lnk: Cmp.ni.admin.11, uris: [Cmp.ni, Usr.lwe]}
  lnkUsr.lwe_Cmp.ni_admin:
    _cls: Cmp
    slug: ni
    pars:
      - {lnk: Pl.cr.home}
    pths:
      - {lnk: Pl.cr.home, uris: [Pl.cr, Usr.lwe]}

  PrsLarryWayne:
    _cls: Prs
    _types : [Prs]
    slug  : larrywayne
    fNam  : Larry
    lNam  : Wayne
    pths :
      - _cls: Pth
        _types : [Pth]
        lnks:
          - _cls: Lnk
            _types : [Lnk]
            uri: Prs.lwe
          - _cls: Lnk
            _types : [Lnk]
            uri: Cmp.ni
    emails:
      - _cls   : Email
        _types : [Email]
        typ    : home
        address: bill@ms.com
        prim   : true
      - _cls   : Email
        _types : [Email]
        typ    : work
        address: steve@apple.com


sampDat:
  examples:
    Cmp.ni:
      _cls  : Cmp
      _types: [Cmp]
      slug  : ni
      cNam  : GSNI
      pars  :
        - {cls: Pl, slug: atlanta, role: office}
      pths  :
        - {cls: Pl, slug: atlanta, role: office, uris: [Pl.atlanta]}
    Cmp.kirmse:
      _cls: Cmp
      _types: [Cmp]
      typ: dept
      slug: kirmse
      cNam: Kirmse
      pars:
        - {cls: Cmp, slug: ni, role: dept}
        # Here view will always be from parent looking at list of children. So parent wants to see role as child.
      pths:
        - {cls: Cmp, slug: ni, role: company, uris: [Cmp.ni]}
        # role as company ref'd here because view will be from kirse looking at parent relations. So kirmse see ni as company.

    Usr.lwe:
      _cls  : Usr
      _types: [Usr]
      slug  : lwe
      fNam  : Larry
      lNam  : Wayne
      uNam  : lwe
      pars  :
        - {cls: Cmp, slug: ni, role: consultant, mask: 11}
        - {cls: Pl, slug: sandiego, role: home}
      pths  :
        - {cls: Cmp, slug: ni, role: client, uris: [Cmp.ni]}
        - {cls: Pl, slug: sandiego, role: home, uris: [Pl.sandiego]}
        - {cls: Pl, slug: atlanta, role: office, uris: [Pl.atlanta, Cmp.ni]}
  initload:            
    belencr:
      _cls: Pl
      slug  : belencr
      city  : Belen
    lwe:
      _cls: Usr
      slug  : lwe
      uNam  : larryeitel
      fNam  : Larry
      lNam  : Eitel
    sallysmith:
      _cls: Usr
      slug  : sallysmith
      uNam  : sallysmith
      fNam  : Sally
      lNam  : Smith
    suziebell:
      _cls: Usr
      slug  : suziebell
      uNam  : suziebell
      fNam  : Suzie
      lNam  : Bell
    ni:
      _cls: Cmp
      typ: company
      slug: ni
      cNam: GSNI
    prggrp:
      _cls: Cmp
      typ: department
      slug: prggrp
      cNam: Program Group
    kirmse:
      _cls: Cmp
      typ: area
      slug: kirmse
      cNam: Kirmse
    unit104:
      _cls: Cmp
      typ: unit
      slug: unit104
      cNam: "104"    
    troop1031:
      _cls: Cmp
      typ: troop
      slug: troop1031
      cNam: "1031"    
  initload:  
    atlanta-ga:
      _cls: Pl
      slug  : atlanta-ga
      city  : Atlanta         
    ni:
      _cls: Cmp
      typ: company
      slug: ni
      cNam: GSNI
    kirmse:
      _cls: Cmp
      typ: area
      slug: kirmse
      cNam: Kirmse
    unit104:
      _cls: Cmp
      typ: unit
      slug: unit104
      cNam: "104"    
    troop1031:
      _cls: Cmp
      typ: troop
      slug: troop1031
      cNam: "1031"          